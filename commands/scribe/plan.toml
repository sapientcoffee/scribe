description = "Creates a structured BLUEPRINT.md file for a project within its dedicated directory."
prompt = """
@{context/core.md}
@{context/architect.md}

## Task: Create Blueprint

A user has requested you create a plan for the project: {{args}}

## 1. Planning Protocol (Strict Rules)
*   **Mandatory File Discovery:** Your first action MUST be to locate and read the `RESEARCH.md` file within the current project's dedicated directory (e.g., `scribe/{{args}}/RESEARCH.md`). Use your tools to search for it before proceeding. If you cannot find it, inform the user and stop.
*   **ReadOnly Mode:** You must not edit any files except for creating the new blueprint within the project's directory.
*   **Context:** You MUST use the information in `RESEARCH.md` to inform the plan's structure and content.
*   **Output:** Your final output MUST be a new file named `BLUEPRINT.md` within the current project's dedicated directory.
*   **Clarify Ambiguity:** Before creating `BLUEPRINT.md`, if the user's request is vague, ambiguous, or if there are conflicts with `RESEARCH.md`, you must present a brief summary of your understanding and ask clarifying questions to ensure the blueprint is accurate and complete. If the request is clear, proceed directly.

## 2. File Handling
*   **Collision Check (`BLUEPRINT.md`):**
    *   Check if `BLUEPRINT.md` already exists within the current project's directory.
    *   If it exists, **stop and ask the user** how to proceed. You must offer at least these options:
        1.  **Overwrite:** Replace the existing file.
        2.  **New Version:** Create a new versioned file (e.g., `BLUEPRINT_v2.md`).
        3.  **New Git Branch:** Offer to create a new Git branch to isolate this workflow (assuming the user is operating within a Git repository).
    *   Do not write content until you have a decision.

## 3. The "Blueprint" Output Format
Your final output in `BLUEPRINT.md` must be a structured outline. Use the document structures defined in `scribe.md` as a guide.

# Blueprint: [Project Name]

## 1. Objective
*   [A one-sentence summary of the document's goal.]

## 2. Target Audience
*   [Describe the primary reader, based on `scribe.md` and `RESEARCH.md`.]

## 3. Core Sections (Outline)
*   ### Section 1: [Title]
    *   **Key Point:** [Detail to cover]
    *   **Supporting Data:** [Reference from RESEARCH.md]
*   ### Section 2: [Title]
    *   **Key Point:** [Detail to cover]
*   ...

## 4. Special Requirements
*   **Tone:** [e.g., Professional, Conversational]
*   **Keywords:** [e.g., "Generative AI", "CLI"]
*   **Call to Action:** [e.g., "Sign up for the beta."]

## 5. Error Handling
*   If `RESEARCH.md` is not found, inform the user and suggest running `/scribe:research` for the given project name.
*   If file write operations fail, provide specific error messages and suggested solutions.

## 6. File Validation
*   Verify that `BLUEPRINT.md` (after creation) contains valid Markdown formatting.
*   Verify that `RESEARCH.md` is valid and readable before processing its content.

---
*User Request: {{args}}*
"""